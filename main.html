
<html>
<!-- å¼•å…¥ jQuery èˆ‡ Select2 -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>é›»ç¹¡ä¼°åƒ¹å–®</title>
  <script src="jquery-3.6.3.min.js"></script>
  
 <style>
		table {
			border-collapse: collapse;
			border: 2px solid black;
		}
		td {
			border: 2px solid black;
			padding: 10px;
		}
		tr {
			border: 2px solid black;
			padding: 10px;
		}
		th {
			border: 2px solid black;
			padding: 10px;
		}
</style>		
  
</head>

<body>
<div class="mode">
  <label><strong>1. æµç¨‹èªªæ˜:</strong></label>
  <ol style="margin-top:8px; line-height:1.8;">
    <li>æ­£ç¢ºå¡«å¯«ä¸‹è¡¨éœ€æ±‚åŠå…§å®¹ï¼Œä»¥åŠé€£çµ¡æ–¹å¼ã€‚</li>
    <li>å¯å…ˆé»é¸ã€ä¼°åƒ¹ã€‘ç¢ºèªé›»ç¹¡é‡‘é¡ã€‚</li>
    <li>
      æ‰€æœ‰è³‡æ–™ç¢ºèªç„¡èª¤å¾Œï¼Œå‹™å¿…é»é¸ã€
      <span style="color:red; font-weight:bold;">ä¼°åƒ¹ä¸¦é€å–®</span>
      ã€‘ï¼Œæ„›ç†æ‰æœƒæ”¶åˆ°æ‚¨çš„é›»ç¹¡ç”³è«‹ã€‚
    </li>
    <li>
      ç³»çµ±å°‡æ–¼åŒé é¢æä¾›ã€Œ
      <span style="color:red;">é›»ç¹¡å–®å–®è™Ÿ</span>
      ã€åŠã€Œ
      <span style="color:red;">é›»ç¹¡éœ€ä¸‹å–®æ•¸é‡</span>
      ã€ã€‚
    </li>
    <li>
      æ–¼å®˜ç¶²ä¸‹è¨‚æ™‚ï¼Œé›»ç¹¡è«‹ä¾ç…§ã€Œ
      <span style="color:red;">é›»ç¹¡éœ€ä¸‹å–®æ•¸é‡</span>
      ã€é€²è¡Œè¨‚è³¼ã€‚
    </li>
    <li>
      è«‹å°‡ã€Œ
      <span style="color:red;">é›»ç¹¡å–®å–®è™Ÿ</span>
      ã€å¡«å¯«æ–¼å®˜ç¶²çµå¸³é é¢çš„ã€
      <span style="color:red;">è¨‚å–®å‚™è¨»</span>
      ã€‘æ¬„ä½å…§ã€‚
    </li>
    <li>å®˜ç¶²è¨‚å–®ä»˜æ¬¾å®Œæˆå¾Œï¼Œæ„›ç†å³æœƒé–‹å§‹è£½ä½œã€‚</li>
  </ol>
  <p style="margin-top:12px; 
         color:red; 
         font-weight:bold;
         background-color: #fff3cd;
         padding: 10px 12px;
         border-radius: 6px;">
  æé†’æ‚¨ï¼šå®¢è£½åŒ–å•†å“æ–¼ä¸‹å–®ä»˜æ¬¾å®Œæˆå¾Œï¼Œæ•ç„¡æ³•ä¿®æ”¹å…§å®¹æˆ–å–æ¶ˆè¨‚å–®ï¼Œ
  è«‹ç¢ºèªå®Œæ•´ç„¡èª¤å¾Œå†é€å–®åŠä¸‹è¨‚ã€‚
</p>
</div>
<br />

<!--æ¯ä»¶ç¹¡ä¸ä¸€æ¨£-->
<div class="fill2" style="display:block">
<label><strong>2. å¡«å¯«éœ€æ±‚åŠå…§å®¹:</strong></label><br /><br />
è¨‚å–®è™Ÿ: <input id="input_ordernumber" placeholder="M12345 or #20250101123456 å°šæœªæœ‰è¨‚å–®è™Ÿå¯å…å¡«" size="50"><br /><br />

<form id="orderForm">
<table class="table2" border="0">
    <thead>
    <tr>
	    <th>åºè™Ÿ</th>
		<th>å•†å“è²¨è™Ÿ</th>
		<th>é¡è‰²</th>
		<th>è¢–é•·</th>
        <th>å°ºå¯¸</th>
        <th>ä»¶æ•¸</th>
		<th>é›»ç¹¡ä½ç½®</th>
		<th>é›»ç¹¡å­—é«”</th>
		<th>é›»ç¹¡é¡è‰²</th>
		<th>é›»ç¹¡å…§å®¹(ç¬¬ä¸€è¡Œ)</th>
		<th>é›»ç¹¡å…§å®¹(ç¬¬äºŒè¡Œ)</th>
    </tr>
    </thead>
    <tbody>
    <tr id="clo2">
        <td class="td2">1</td>
<script>
const colorMap = {
  "A148": { "A0": "å¯¶å¯¶ç²‰", "W0": "ç´”ç²¹ç™½" },
  "A204": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "W0": "ç´”ç²¹ç™½" },
  "A222": { "B0": "å¯¶å¯¶è—" },
  "A246": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«" },
  "A248": { "A0": "å¯¶å¯¶ç²‰", "W0": "ç´”ç²¹ç™½" },
  "A302": { "W0": "ç´”ç²¹ç™½" },
  "A305": { "W0": "ç´”ç²¹ç™½" },
  "A502": { "W0": "ç´”ç²¹ç™½" },
  "A505": { "W0": "ç´”ç²¹ç™½" },

  "AB251": { "A2": "æ¢…å­ç²‰", "C2": "è¿·éœ§ç´«", "F0": "ç²‰éœ§æ©˜", "F1": "æä»å¥¶" },
  "AB252": { "E2": "é›ªæ¾ç¶ ", "W3": "è“‹äºç°", "W6": "ç°è’¼è—", "W7": "æš—å²©ç°" },
  "AB719": { "A2": "æ¢…å­ç²‰", "B5": "åŒ—æ­è—", "B7": "è”šæµ·è—", "C2": "è¿·éœ§ç´«", "E2": "é›ªæ¾ç¶ ", "F0": "ç²‰éœ§æ©˜", "F1": "æä»å¥¶", "F8": "ç¤¦ç‰©æ£•", "W3": "è“‹äºç°", "W6": "ç°è’¼è—" },

  "AC719": { "B9": "æ·±æµ·è—", "F7": "æš—æ£—ç´…", "W7": "æš—å²©ç°", "W9": "çŸ³å¢¨é»‘" },

  "AS136": { "W7": "æš—å²©ç°" },
  "AS150": { "B0": "å¯¶å¯¶è—", "B9": "æ·±æµ·è—" },
  "AS250": { "B0": "å¯¶å¯¶è—", "B9": "æ·±æµ·è—" },
  "AS251": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "B9": "æ·±æµ·è—", "W0": "ç´”ç²¹ç™½" },
  "AS716": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«", "C7": "è‘¡è„ç´«", "F1": "å¡å…¶ç°", "W8": "å¤œå¹•é»‘" },
  "AS7161": { "W8": "å¤œå¹•é»‘" },
  "AS717": { "A9": "é‡€é…’ç´…", "C7": "è‘¡è„ç´«", "W6": "ç°è’¼è—" },
  "AS718": { "B0": "å¯¶å¯¶è—", "W6": "ç°è’¼è—", "W7": "æš—å²©ç°", "W8": "å¤œå¹•é»‘" },
  "AS7181": { "B0": "å¯¶å¯¶è—", "W6": "ç°è’¼è—", "W7": "æš—å²©ç°", "W8": "å¤œå¹•é»‘" },
  "AS804": { "B9": "æ·±æµ·è—" },

  "B101": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },
  "B108": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«", "W0": "ç´”ç²¹ç™½" },
  "B110": { "C0": "ä¸é¦™ç´«", "D0": "å¤©å ‚è—" },
  "B111": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },
  "B122": { "C0": "ä¸é¦™ç´«", "D0": "å¤©å ‚è—" },
  "B133": { "A0": "å¯¶å¯¶ç²‰" },
  "B201": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "W0": "ç´”ç²¹ç™½" },
  "B202": { "W0": "ç´”ç²¹ç™½" },
  "B204": { "A0": "å¯¶å¯¶ç²‰", "D0": "å¤©å ‚è—", "W0": "ç´”ç²¹ç™½" },
  "B208": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«", "W0": "ç´”ç²¹ç™½" },
  "B210": { "C0": "ä¸é¦™ç´«", "D0": "å¤©å ‚è—" },
  "B211": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "W0": "ç´”ç²¹ç™½" },
  "B222": { "A0": "å¯¶å¯¶ç²‰" },
  "B233": { "A0": "å¯¶å¯¶ç²‰" },
  "B235": { "W0": "ç´”ç²¹ç™½" },
  "B241": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«" },
  "B302": { "W0": "ç´”ç²¹ç™½" },
  "B304": { "W0": "ç´”ç²¹ç™½" },
  "B305": { "W0": "ç´”ç²¹ç™½" },
  "B502": { "W0": "ç´”ç²¹ç™½" },
  "B505": { "W0": "ç´”ç²¹ç™½" },
  "B603": { "D0": "å¤©å ‚è—" },
  "B608": { "D0": "å¤©å ‚è—" },
  "B801": { "A0": "å¯¶å¯¶ç²‰", "W0": "ç´”ç²¹ç™½" },
  "B802": { "A0": "å¯¶å¯¶ç²‰", "W0": "ç´”ç²¹ç™½" },

  "C302": { "W0": "ç´”ç²¹ç™½" },
  "C303": { "W0": "ç´”ç²¹ç™½" },
  "C304": { "W0": "ç´”ç²¹ç™½" },
  "C503": { "W0": "ç´”ç²¹ç™½" },
  "C605": { "B9": "æ·±æµ·è—" },
  "C605A": { "B9": "æ·±æµ·è—" },
  "C709": { "A3": "çŠç‘šç²‰", "B7": "å¯¶çŸ³è—", "B9": "æ·±æµ·è—", "C7": "è‘¡è„ç´«", "F7": "æš—æ£—ç´…" },
  "C7091": { "B7": "å¯¶çŸ³è—", "B9": "æ·±æµ·è—" },
  "C713": { "C6": "äº®ç´«ç´…", "E5": "æŠ¹èŒ¶ç¶ ", "F5": "è±†æ²™ç´…" },
  "C714": { "A3": "çŠç‘šç²‰", "B9": "æ·±æµ·è—", "C0": "ä¸é¦™ç´«" },
  "C805N1": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },

  "D303": { "W0": "ç´”ç²¹ç™½" },
  "D305": { "W0": "ç´”ç²¹ç™½" },
  "D503": { "W0": "ç´”ç²¹ç™½" },

  "F603": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "C0": "ä¸é¦™ç´«", "E0": "æœå­ç¶ " },
  "F6041": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "E0": "æœå­ç¶ " },
  "F605": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«", "E0": "æœå­ç¶ " },
  "F605A": { "A0": "å¯¶å¯¶ç²‰", "C0": "ä¸é¦™ç´«", "E0": "æœå­ç¶ " },
  "F608": { "A0": "å¯¶å¯¶ç²‰" },
  "F609": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—", "C0": "ä¸é¦™ç´«", "E0": "æœå­ç¶ " },
  "F611": { "B0": "å¯¶å¯¶è—", "C0": "ä¸é¦™ç´«", "E0": "æœå­ç¶ " },

  "I245": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },
  "I704": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },
  "I712": { "A0": "å¯¶å¯¶ç²‰", "B0": "å¯¶å¯¶è—" },

  "W403": { "A0": "å¯¶å¯¶ç²‰", "A6": "äº®æ¡ƒç´…", "B0": "å¯¶å¯¶è—", "B9": "æ·±æµ·è—", "C7": "è‘¡è„ç´«" },
  "W4031": { "B9": "æ·±æµ·è—" },
  "W460": { "A1": "æ´»æ½‘ç²‰", "B9": "æ·±æµ·è—", "C7": "è‘¡è„ç´«" }
};

</script>
<script>
document.addEventListener("change", function(e) {

  if (e.target.classList.contains("s_product-code")) {

    const productSelect = e.target;
    const selectedCode = productSelect.value;

    // æ‰¾åŒä¸€åˆ—çš„é¡è‰² select
    const colorSelect = productSelect.closest("tr").querySelector(".s_color");

    // æ¸…ç©ºèˆŠé¡è‰²
    colorSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';

    // ä¾è²¨è™ŸåŠ å…¥é¡è‰² (ç‰©ä»¶æ ¼å¼)
    if (colorMap[selectedCode]) {
      for (const code in colorMap[selectedCode]) {
        const opt = document.createElement("option");
        opt.value = code + colorMap[selectedCode][code]; // value å¯ç”¨ä»£ç¢¼+ä¸­æ–‡
        opt.textContent = `${code} ${colorMap[selectedCode][code]}`; // é¡¯ç¤ºã€Œä»£ç¢¼ ä¸­æ–‡åç¨±ã€
        colorSelect.appendChild(opt);
      }
    }
  }

});
</script>
		<td>
			<select id="product-code" name="product_code[]" class="s_product-code" style="width:100px">
				<option value="">è«‹é¸æ“‡</option>
				<option value="A148">A148</option>
				<option value="A204">A204</option>
				<option value="A222">A222</option>
				<option value="A246">A246</option>
				<option value="A248">A248</option>
				<option value="A302">A302</option>
				<option value="A305">A305</option>
				<option value="A502">A502</option>
				<option value="A505">A505</option>
				<option value="AB251">AB251</option>
				<option value="AB252">AB252</option>
				<option value="AB719">AB719</option>
				<option value="AC719">AC719</option>
				<option value="AS136">AS136</option>
				<option value="AS150">AS150</option>
				<option value="AS250">AS250</option>
				<option value="AS251">AS251</option>
				<option value="AS716">AS716</option>
				<option value="AS7161">AS7161</option>
				<option value="AS717">AS717</option>
				<option value="AS718">AS718</option>
				<option value="AS7181">AS7181</option>
				<option value="AS804">AS804</option>
				<option value="B101">B101</option>
				<option value="B108">B108</option>
				<option value="B110">B110</option>
				<option value="B111">B111</option>
				<option value="B122">B122</option>
				<option value="B133">B133</option>
				<option value="B201">B201</option>
				<option value="B202">B202</option>
				<option value="B204">B204</option>
				<option value="B208">B208</option>
				<option value="B210">B210</option>
				<option value="B211">B211</option>
				<option value="B222">B222</option>
				<option value="B233">B233</option>
				<option value="B235">B235</option>
				<option value="B241">B241</option>
				<option value="B302">B302</option>
				<option value="B304">B304</option>
				<option value="B305">B305</option>
				<option value="B502">B502</option>
				<option value="B505">B505</option>
				<option value="B603">B603</option>
				<option value="B608">B608</option>
				<option value="B801">B801</option>
				<option value="B802">B802</option>
				<option value="C302">C302</option>
				<option value="C303">C303</option>
				<option value="C304">C304</option>
				<option value="C503">C503</option>
				<option value="C605">C605</option>
				<option value="C605A">C605A</option>
				<option value="C7021">C7021</option>
				<option value="C709">C709</option>
				<option value="C7091">C7091</option>
				<option value="C713">C713</option>
				<option value="C714">C714</option>
				<option value="C805N1">C805N1</option>
				<option value="D303">D303</option>
				<option value="D305">D305</option>
				<option value="D503">D503</option>
				<option value="F603">F603</option>
				<option value="F6041">F6041</option>
				<option value="F605">F605</option>
				<option value="F605A">F605A</option>
				<option value="F608">F608</option>
				<option value="F609">F609</option>
				<option value="F611">F611</option>
				<option value="I245">I245</option>
				<option value="I704">I704</option>
				<option value="I712">I712</option>
				<option value="W403">W403</option>
				<option value="W4031">W4031</option>
				<option value="W460">W460</option>
			  </select>
		</td>

<script>
  $(document).ready(function() {
    $('#product-code').select({
      placeholder: "è«‹é¸æ“‡æˆ–è¼¸å…¥è²¨è™Ÿ",
      allowClear: true
    });
  });
</script>

		<td>
		  <select class="s_color" name="s_color[]" style="width:100px">
			<option value="">è«‹é¸æ“‡</option>
		  </select>
		</td>
        <td> <select class="s_sleeve" name="s_sleeve[]"> <!-- è¢–é•· -->
			    <option value="">è«‹é¸æ“‡</option>
				<option value="short">çŸ­è¢–</option>
				<option value="long">é•·è¢–</option>
				<option value="three_quarter">ä¸ƒåˆ†è¢–</option>
		     </select>
		</td>
		<td>
		  <select class="s_size" name="s_size[]">
			<option value="">è«‹é¸æ“‡</option>
			<option value="æ•´æ‰¹ç¹¡ä¸€æ¨£">æ•´æ‰¹ç¹¡ä¸€æ¨£</option>
			<option value="XS">XS</option>
			<option value="S">S</option>
			<option value="M">M</option>
			<option value="L">L</option>
			<option value="XL">XL</option>
			<option value="2XL">2XL</option>
			<option value="3XL">3XL</option>
			<option value="4XL">4XL</option>
			<option value="5XL">5XL</option>
			<option value="6XL">6XL</option>
			<option value="7XL">7XL</option>
			<option value="8XL">8XL</option>
		  </select>
		</td>
		<td> <input name="i_number[]" placeholder="" size="10" /></td> <!-- ä»¶æ•¸ -->
		<td> <select class="s_position" name="s_position[]"> <!-- é›»ç¹¡ä½ç½® -->
			    <option value="">è«‹é¸æ“‡</option>
				<option value="left_chest">å·¦èƒ¸å£è™•</option>
				<option value="right_chest">å³èƒ¸å£è™•</option>
				<option value="above_left_pocket">å·¦èƒ¸å£è¢‹ä¸Šæ–¹</option>
				<option value="above_right_pocket">å³èƒ¸å£è¢‹ä¸Šæ–¹</option>
		     </select>
		</td>
		<td> <select class="s_font" name="s_font[]"> <!-- é›»ç¹¡å­—é«” -->
			    <option value="">è«‹é¸æ“‡</option>
				<option value="ch_kai">ä¸­æ–‡-æ¨™æ¥·é«”</option>
				<option value="ch_heavy">ä¸­æ–‡-è¯åº·ä¸­é»‘é«”</option>
				<option value="en_kai">è‹±æ–‡-æ¨™æ¥·é«”</option>
				<option value="en_arial">è‹±æ–‡-Arial</option>
				<option value="en_brush_script_mt">è‹±æ–‡-Brush Script MT</option>
				<option value="en_kunstler_script">è‹±æ–‡-Kunstler Script</option>
		     </select>
		</td>
		<td> <select class="s_embroidery_color" name="s_embroidery_color[]"> <!-- é›»ç¹¡é¡è‰² -->
			    <option value="">è«‹é¸æ“‡</option>
				<option value="700_apple_red">700 è˜‹æœç´…</option>
				<option value="535_orange_red">535 æ©˜ç´…è‰²</option>
				<option value="525_golden_yellow">525 é‡‘é»ƒè‰²</option>
				<option value="233_apple_green">233 é’è˜‹ç¶ </option>
				<option value="323_teal">323 è—ç¶ è‰²</option>
				<option value="367_royal_blue">367 å¯¶è—è‰²</option>
				<option value="335_navy">335 ä¸ˆé’è‰²</option>
				<option value="676_dark_purple">676 æ·±ç´«è‰²</option>
				<option value="745_bronze">745 å¤éŠ…è‰²</option>
				<option value="900_black">900 æ™‚å°šé»‘</option>
				<option value="800_white">800 å¤©ä½¿ç™½</option>
				<option value="483_silver_gray">483 éŠ€ç°è‰²</option>
		     </select>
		</td>
		<!-- é›»ç¹¡å…§å®¹1 maxlengthå­—æ•¸é™åˆ¶-->

			<td><input id="embroidery1" name="i_embroidery1[]" placeholder="å­—æ•¸é™åˆ¶ï¼Œè¶…éè‡ªå‹•åˆªé™¤"/></td>
			<td><input id="embroidery2" name="i_embroidery2[]" placeholder="å­—æ•¸é™åˆ¶ï¼Œè¶…éè‡ªå‹•åˆªé™¤"/></td>

			<script>
			  const maxLength = 5; // è‡ªè¨‚é™åˆ¶

			  function getLength(str) {
				let len = 0;
				for (let char of str) {
				  if (char.charCodeAt(0) > 255) {
					len += 1;   // ä¸­æ–‡ã€å…¨å½¢
				  } else {
					len += 0.5; // è‹±æ–‡ã€åŠå½¢
				  }
				}
				return len;
			  }

			  function trimToMax(str) {
				while (getLength(str) > maxLength) {
				  str = str.slice(0, -1);
				}
				return str;
			  }

			  function applyLimit(inputId) {
				const input = document.getElementById(inputId);
				input.addEventListener("blur", function () {
				  input.value = trimToMax(input.value);
				});
			  }

			  // å¥—ç”¨åˆ°å…©å€‹æ¬„ä½
			  applyLimit("embroidery1");
			  applyLimit("embroidery2");
			</script>
		
    </tr>
    </tbody>
</table>

<!-- éš±è—æ¬„ä½ï¼Œç”¨ä¾†æ”¾çµ„å¥½çš„ HTML è¡¨æ ¼çµ¦ EmailJS -->
<input type="hidden" name="table_content" id="table_content">
<input type="hidden" name="user_name" id="user_name"> <!-- è¯çµ¡äººå§“å emailjsç”¨-->
<input type="hidden" name="user_email" id="user_email"> <!-- email emailjsç”¨-->

<input type="hidden" name="user_ordernumber" id="user_ordernumber"> <!-- å–®è™Ÿ emailjsç”¨-->
<input type="hidden" name="user_company" id="user_company"> <!-- å–®ä½åç¨± emailjsç”¨-->
<input type="hidden" name="user_phone" id="user_phone"> <!-- é›»è©± emailjsç”¨-->

<input type="hidden" name="user_memory" id="user_memory"> <!-- é‡‘éŒ¢ emailjsç”¨-->

<input type="hidden" name="user_serialnumber" id="user_serialnumber"> <!-- é›»ç¹¡å–®å–®è™Ÿ emailjsç”¨-->

<br />
<button type="button" onclick="fun('table2','clo2','td2')">æ–°å¢ä¸€è¡Œ</button>
&nbsp;<button type="button" onclick="fun_same('table2','clo2','td2')">è¤‡è£½æœ€å¾Œä¸€è¡Œ</button>
&nbsp;<button type="button" onclick="del('table2')">åˆªé™¤æœ€å¾Œä¸€è¡Œ</button>

<br />
<br />
</div>
<!--
<div class="fill3" style="display:none">
<label><strong>ç¹¡å­—å…§å®¹:</strong></label>
<br />
&nbsp;&nbsp;é›»ç¹¡å…§å®¹(ç¬¬ä¸€è¡Œ): <input name="myfield3" value="æ„›ç†é†«é™¢1" size="50">
&nbsp;&nbsp;é›»ç¹¡å…§å®¹(ç¬¬äºŒè¡Œ): <input name="myfield4" value="æ„›ç†é†«é™¢2" size="50">
<br />
</div>
-->
<div class="fill4" style="display:block">
<br />
<label><strong>3. è¯çµ¡æ–¹å¼</strong></label>
<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;å–®ä½åç¨±: <input id="input_company" name="myname" size="30"> <br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;è¯çµ¡äººå§“å: <input id="input_name" name="myname" size="30"> <br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;é›»è©±: <input id="input_phone" name="myphone" size="30"> <br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;e-mail: <input id="input_email" name="myemail" size="50"> <br />
</div>
</body>

<div class="note">
    <br />
    <label><strong>4.</strong></label>
    <br />
    <label style="color: red;"><strong>åªè¨ˆç®—é‡‘é¡è«‹é¸ã€Œä¼°åƒ¹ã€</strong></label>
    <br />
    <label style="color: red;"><strong>é€å‡ºè¨‚å–®è«‹é¸ã€Œä¼°åƒ¹ä¸¦é€å–®ã€</strong></label>
    <br />
    <label style="color: red;"><strong>è«‹æ³¨æ„ï¼Œé¸æ“‡ã€Œä¼°åƒ¹ä¸¦é€å–®ã€æ„›ç†æ‰æœƒæ”¶åˆ°æ‚¨çš„è¨‚å–®å”·</strong></label>
    <br />
    <br />
    <label style="color: blue;"><strong>â˜†</strong></label>
	<br />
	<label style="color: blue;"><strong>ä¸­æ–‡ 1 å­—ï¼š30å…ƒ</strong></label>
	<br />
	<label style="color: blue;"><strong>è‹±æ–‡ 1 å­—ï¼š15å…ƒ</strong></label>
	<br />
	<label style="color: blue;"><strong>æ•¸å­— 1 å­—ï¼š15å…ƒ</strong></label>
	<br />
	<label style="color: blue;"><strong>ç¬¦è™Ÿ 1 å­—ï¼š15å…ƒ</strong></label>
	<br />
	<label style="color: blue;"><strong>ç©ºã€€æ ¼ï¼šä¸ç®—è²»ç”¨</strong></label>
</div>


<div class="botton1" style="display:block">
<br />
<label id="final_price" style="color:black; font-size:18px;"></label>
<br />
<br />
<button type="button" id="nosave">ä¼°åƒ¹</button>
<button type="submit" id="save">ä¼°åƒ¹ä¸¦é€å–®</button>
</div>
</form>

<div id="display_serialnumber" class="highlighted"></div>

<div class="price" style="display:block">
<br />
<label id="final_id" style="color:red;"></label>
 <button type="button" id="copyButton" style="display:none">æŒ‰æ­¤è¤‡è£½é›»ç¹¡å–®å–®è™Ÿ</button>
<br />

</div>

<!-- å®¢è£½åŒ–å½ˆçª— -->
<div id="myConfirm" style="display:none; 
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.5); 
    justify-content:center; align-items:center;">

	<div style="background:#fff; padding:20px; border-radius:10px; text-align:center; width:300px;">
	  <p>ç¢ºå®šè¼¸å…¥éƒ½æ­£ç¢ºä¸¦æº–å‚™é–‹å§‹ä¼°åƒ¹å­˜æª”å—?</p>
	  <p style="color:black; font-weight:bold;">
	    !!è«‹è¨˜å¾—<span style="color:red; font-size:18px;">è¤‡è£½é›»ç¹¡å–®è™Ÿ</span>åˆ°<span style="color:red; font-size:18px;">è¨‚å–®å‚™è¨»æ¬„</span> !!
	  </p>
	  <button id="okBtn">ç¢ºå®š</button>
	  <button id="cancelBtn">å–æ¶ˆ</button>
	</div>
</div>

<style>
.highlighted {
    color: red;
    font-weight: bold;
    font-size: 1.2em;
    background-color: #fff0f0;
    padding: 4px 8px;
    border-radius: 4px;
}
</style>

<script>

var final_id = "";
var i = 1;
var total_price = 0;
var chinese_num = 0;
var english_num = 0;
var chinese_price = 0;
var english_price = 0;
var price_ch = 30;
var price_en = 15;


$(".td").each(function(){
	$(this).html(i++);
})

function fun_same(ta, col, v) {
    var $table = $("." + ta);
    var $lastRow = $table.find("tr:last");
    var $clonedLastRow = $lastRow.clone();

    // è¦è¤‡è£½çš„ select class åˆ—è¡¨
    var fieldsToCopy = [
	    "s_product-code",
		"s_color",
        "s_sleeve",
		"s_size",
        "s_position",
        "s_font",
        "s_embroidery_color"
    ];

    // è¤‡è£½æ¯å€‹æ¬„ä½çš„å€¼
    fieldsToCopy.forEach(function(className) {
        var originalVal = $lastRow.find("." + className).val();
        $clonedLastRow.find("." + className).val(originalVal);
    });

    // åŠ å…¥è¤‡è£½è¡Œ
    $table.append($clonedLastRow);

    // æ›´æ–°åºè™Ÿ
    var i = 1;
    $("." + v).each(function () {
        $(this).html(i++);
    });
}

function fun(ta,col,v){
	var $td = $("#"+col).clone();       //å¢åŠ ä¸€è¡Œ,å…‹éš†ç¬¬ä¸€å€‹å°è±¡
	$("."+ta).append($td);
	var i = 1;
	$("."+v).each(function(){       //å¢åŠ ä¸€è¡Œå¾Œé‡æ–°æ›´æ–°åºè™Ÿ1,2,3......
	$(this).html(i++);
	})
	$("."+ta+" tr:last").find(":input").val('');   //å°‡å°¾è¡Œå…ƒç´ å…‹éš†ä¾†çš„ä¿å­˜çš„å€¼æ¸…ç©º
}

function del(ta){
	$("."+ta+" tr:not(:first):not(:first):last").remove();//ç§»é™¤æœ€å¾Œä¸€è¡Œ,ä¸¦ä¸”ä¿ç•™å‰å…©è¡Œ
}

function sum_money(myfield) {
		var pattern = new RegExp("[\u4E00-\u9FA5]+") //åˆ¤æ–·ä¸­æ–‡
		
		var c_chinese = 0;
		var c_other = 0;
		var c_space = 0;
		for (let i = 0; i < myfield.length; i++) {
			if (pattern.test(myfield[i])) {
			    //alert(myfield[i])
				c_chinese++;
			} else {
			    //alert("ä¸æ˜¯ä¸­æ–‡:"+myfield[i])
				if (myfield[i] != " " && myfield[i] != "ã€€")
				    c_other++;
			    else
				    c_space++;
		    }
		}
		
		var price_ch_all = c_chinese * price_ch;
		var price_en_all = c_other * price_en;
		var price_all = price_ch_all + price_en_all;
		
		return {chinese:c_chinese, other:c_other, price_ch:price_ch_all, price_en:price_en_all, price:price_all};
}

function final_cal() {
    // Reset variables and UI elements
    $('#final_id').text("");
    $('#copyButton').css("display", "none");
    $('#final_price').text("");
    $(".price").css("display", "none");
    final_id = "";
    total_price = 0;
    chinese_num = 0;
    english_num = 0;
    chinese_price = 0;
    english_price = 0;

    var isValid = true;
    var errorMessage = "";
	let errorMessages = [];

    // Each row of the table will be checked
    $("." + "table2" + " tr").each(function(i) {
        if (i !== 0) { // Skip the header row
            var myfield1 = $(this).find('td:eq(9)').find("input").val().trim(); // First embroidery input
            var myfield2 = $(this).find('td:eq(10)').find("input").val().trim(); // Second embroidery input
            var col_number = $(this).find('td:eq(5)').find("input").val().trim(); // Number input
            var product_code = $(this).find(".s_product-code").val(); // Product code dropdown
            var color = $(this).find(".s_color").val(); // Color dropdown
            var sleeve = $(this).find(".s_sleeve").val(); // Sleeve dropdown
            var size = $(this).find(".s_size").val(); // Size dropdown
            var position = $(this).find(".s_position").val(); // Embroidery position dropdown
            var font = $(this).find(".s_font").val(); // Font dropdown
            var embroidery_color = $(this).find(".s_embroidery_color").val(); // Embroidery color dropdown

            // Check for empty or default values
			if (!product_code)
			{
				errorMessages.push("[å•†å“è²¨è™Ÿ] ");
			}
			if (!color)
			{
				errorMessages.push("[é¡è‰²] ");
			}
			if (!sleeve)
			{
				errorMessages.push("[è¢–é•·] ");
			}
			if (!size)
			{
				errorMessages.push("[å°ºå¯¸] ");
			}
			if (!col_number || parseInt(col_number) <= 0)
			{
				errorMessages.push("[ä»¶æ•¸] ");
			}
			if (!position)
			{
				errorMessages.push("[é›»ç¹¡ä½ç½®] ");
			}
			if (!font)
			{
				errorMessages.push("[é›»ç¹¡å­—é«”] ");
			}
			if (!embroidery_color)
			{
				errorMessages.push("[é›»ç¹¡é¡è‰²] ");
			}
			if (myfield1.length === 0)
			{
				errorMessages.push("[é›»ç¹¡å…§å®¹(ç¬¬ä¸€è¡Œ)] ");
			}
			if (errorMessages.length > 0) {
				errorMessages.push("\n!! ä»¥ä¸Šæ¬„ä½è³‡æ–™ä¸å®Œæ•´ï¼Œè«‹é‡æ–°ç¢ºèª !!");
				alert(errorMessages.join("\n"));
				return false; // è‹¥æ˜¯åœ¨é€å–®å‰æª¢æŸ¥ï¼Œå¯ä¸­æ–·æµç¨‹
			}
			
            /*if (!product_code || 
                !color || 
                !sleeve || 
                !size || 
                !position || 
                !font || 
                !embroidery_color || 
                !col_number || 
                parseInt(col_number) <= 0 || 
                (myfield1.length === 0 && myfield2.length === 0)) {
                isValid = false;
                errorMessage = "æ¬„ä½å¡«å¯«æœ‰èª¤,è«‹é‡æ–°ç¢ºèªã€‚"; // Custom error message
                return false; // Break out of the each loop
            }*/
        }
    });

    if (!isValid) {
        alert(errorMessage);
        return; // Exit if validation fails
    }

    // Continue with calculations if valid
    $("." + "table2" + " tr").each(function(i) {
        if (i !== 0) { // Skip the header row
            var myfield1 = $(this).find('td:eq(9)').find("input").val();
            var myfield2 = $(this).find('td:eq(10)').find("input").val();
            var col_number = $(this).find('td:eq(5)').find("input").val();

            var obj1 = sum_money(myfield1);
            var obj2 = sum_money(myfield2);
            total_price += (parseInt(obj1.price) * parseInt(col_number));
            total_price += (parseInt(obj2.price) * parseInt(col_number));
            chinese_num += (parseInt(obj1.chinese) * parseInt(col_number));
            chinese_num += (parseInt(obj2.chinese) * parseInt(col_number));
            english_num += (parseInt(obj1.other) * parseInt(col_number));
            english_num += (parseInt(obj2.other) * parseInt(col_number));
            chinese_price += (parseInt(obj1.price_ch) * parseInt(col_number));
            chinese_price += (parseInt(obj2.price_ch) * parseInt(col_number));
            english_price += (parseInt(obj1.price_en) * parseInt(col_number));
            english_price += (parseInt(obj2.price_en) * parseInt(col_number));
        }
    });

    // Display final price
    $('#final_price').text("ç¸½é‡‘é¡: " + total_price + "å…ƒ");
}
/*
$('#save').click(function(){
	var result = confirm("ç¢ºå®šè¼¸å…¥éƒ½æ­£ç¢ºä¸¦æº–å‚™é–‹å§‹ä¼°åƒ¹å­˜æª”å—?");
	if (result) {
		var final_json = final_cal();
		alert(final_json);

	}
});
*/
$('#nosave').click(function(){
    final_cal();
	$(".price").css("display", "block");
	//$('#final_price').text("ç¸½åƒ¹:" + total_price);
	// æ›´æ–°åˆ°ç¶²é ä¸Šçš„ #final_price
	$('#final_price').html(
	  "ä¸­æ–‡å…± " + chinese_num + " å­—ï¼Œå…± $" + chinese_price + " ï¼Œ" +
	  "è‹±æ–‡ã€æ•¸å­—ã€ç¬¦è™Ÿå…± " + english_num + " å­—ï¼Œå…± $" + english_price + "<br>" +
	  "ç¸½åƒ¹ <b style='color:red;'>$" + total_price + "</b> ï¼Œ<b>è«‹ä¸‹å–® <span style='color:red;'>" + (total_price/15) + "</span> å€‹å–®ä½</b>"
	);
});

$('#copyButton').click(function() {
  var text = final_id;
  var $temp = $('<input>');
  $('body').append($temp);
  $temp.val(text).select();
  document.execCommand('copy');
  $temp.remove();
});

// åŒæ­¥ä½¿ç”¨è€…å¡«çš„ input/select å€¼åˆ° clone
function syncInputValues(original, clone) {
  const originalInputs = original.querySelectorAll('input, select, textarea');
  const clonedInputs = clone.querySelectorAll('input, select, textarea');

  originalInputs.forEach((origEl, idx) => {
    const cloneEl = clonedInputs[idx];

    if (!cloneEl) return;

    if (origEl.tagName === 'SELECT') {
      cloneEl.selectedIndex = origEl.selectedIndex;
    } else {
      cloneEl.value = origEl.value;
    }
  });
}


// å°‡è¡¨æ ¼ä¸­çš„æ‰€æœ‰ select èˆ‡ input çš„å€¼ï¼Œæ›æˆæ–‡å­—é¡¯ç¤º
function prepareTableForEmail(tableOrSelector) {
  let table;

  if (typeof tableOrSelector === "string") {
    table = document.querySelector(tableOrSelector);
  } else {
    table = tableOrSelector;
  }

  // æ›¿æ›æ‰€æœ‰ <select> ç‚ºé¸é …æ–‡å­—
  const selects = table.querySelectorAll('select');
  selects.forEach(select => {
    const selectedText = select.options[select.selectedIndex]?.text || '';
    const span = document.createElement('span');
    span.textContent = selectedText;
    select.replaceWith(span);
  });

  // æ›¿æ›æ‰€æœ‰ <input> ç‚ºè¼¸å…¥å€¼
  const inputs = table.querySelectorAll('input');
  inputs.forEach(input => {
    const span = document.createElement('span');
    span.textContent = input.value;
    input.replaceWith(span);
  });
}

function styleTableForEmail(tableOrSelector) {
  let table;

  // åˆ¤æ–·å‚³é€²ä¾†çš„æ˜¯ selector é‚„æ˜¯ DOM
  if (typeof tableOrSelector === "string") {
    table = document.querySelector(tableOrSelector);
  } else {
    table = tableOrSelector;
  }
  
  table.setAttribute("border", "1");
  table.setAttribute("cellpadding", "8");
  table.style.borderCollapse = "collapse";
  table.style.width = "100%";

  const allCells = table.querySelectorAll("th, td");
  allCells.forEach(cell => {
    cell.style.border = "1px solid #000";
    cell.style.padding = "8px";
    cell.style.textAlign = "center";
    cell.style.fontSize = "14px";
  });
}

function generateSerialNumber() {
    const prefix = "ALLEZ_";
    const now = new Date();
    const month = String(now.getMonth() + 1).padStart(2, '0'); // æœˆ (01-12)
    const day = String(now.getDate()).padStart(2, '0');        // æ—¥ (01-31)
	const hours = String(now.getHours()).padStart(2, '0');
	const minutes = String(now.getMinutes()).padStart(2, '0');
	const seconds = String(now.getSeconds()).padStart(2, '0');
	
	//ç”¢ç”Ÿè‹±æ–‡äº‚æ•¸
	let chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // åªç”¨å¤§å¯«è‹±æ–‡
	let code = "";
	for (let i = 0; i < 3; i++) {
		code += chars.charAt(Math.floor(Math.random() * chars.length));
	}
    
    // ç”¢ç”Ÿ 3 ä½æ•¸äº‚ç¢¼ï¼ˆæ•¸å­—ï¼‰
    const randomNum = Math.floor(Math.random() * 1000);     // 0 - 999
    const randomStr = String(randomNum).padStart(3, '0');       // è£œè¶³ 3 ä½

    //return prefix + month + day + code + randomStr;
	return month + day + + hours + minutes + seconds + code;
}

$(document).ready(function () {
    emailjs.init('u41WSO_Vz4DDKY-hZ'); // æ›æˆä½ çš„ Public Key
});

function myConfirm(callback) {
  const modal = document.getElementById("myConfirm");
  modal.style.display = "flex";

  document.getElementById("okBtn").onclick = function() {
    modal.style.display = "none";
    callback(true);
  };

  document.getElementById("cancelBtn").onclick = function() {
    modal.style.display = "none";
    callback(false);
  };
}

// è¡¨å–®é€å‡º
document.getElementById("orderForm").addEventListener("submit", function(e) {
    e.preventDefault();
	
	// æª¢æŸ¥æ‰€æœ‰æ¬„ä½ä¸å¾—ç‚ºç©º	
	/*if (table_item == "" || table_color == "" || parseInt(table_number) <= 0 || table_position == "" || table_font == "" || table_fontcolor == "") {
	   alert("æ‰€æœ‰æ¬„ä½çš†ç‚ºå¿…å¡«, è«‹é‡æ–°ç¢ºèª");
	   return;
    }*/

    final_cal();
	$(".price").css("display", "block");
	// æ›´æ–°åˆ°ç¶²é ä¸Šçš„ #final_price
	$('#final_price').html(
	  "ä¸­æ–‡å…± " + chinese_num + " å­—ï¼Œå…± $" + chinese_price + " ï¼Œ" +
	  "è‹±æ–‡ã€æ•¸å­—ã€ç¬¦è™Ÿå…± " + english_num + " å­—ï¼Œå…± $" + english_price + "<br>" +
	  "ç¸½åƒ¹ <b style='color:red;'>$" + total_price + "</b> ï¼Œ<b>è«‹ä¸‹å–® <span style='color:red;'>" + (total_price/15) + "</span> å€‹å–®ä½</b>"
	);

    // ç¢ºèªé€å‡º
    myConfirm(function(result){
		if(result) {
			// ğŸ”’ ç¦ç”¨æŒ‰éˆ• 10 ç§’
			const submitButton = document.getElementById("save");
			submitButton.disabled = true;
			submitButton.textContent = "å†·å»10ç§’ä¸­"; // å¯é¸ï¼Œæ”¹è®ŠæŒ‰éˆ•æ–‡å­—

			setTimeout(() => {
				submitButton.disabled = false;
				submitButton.textContent = "ä¼°åƒ¹ä¸¦é€å–®"; // æ¢å¾©åŸæœ¬çš„æŒ‰éˆ•æ–‡å­—
			}, 10000); // 10 ç§’ = 10000 æ¯«ç§’


			// æ‰¾åˆ°åŸå§‹è¡¨æ ¼
			const originalTable = document.querySelector(".table2");

			// è¤‡è£½ä¸€ä»½ï¼ˆä¸å½±éŸ¿ç•«é¢ä¸Šçš„è¡¨æ ¼ï¼‰
			const clonedTable = originalTable.cloneNode(true);

			// ğŸ‘‡ è§£æ±º select/input å€¼æ²’è·Ÿè‘—è¤‡è£½çš„å•é¡Œ
			syncInputValues(originalTable, clonedTable);

			// å° clone åšéœæ…‹åŒ–è™•ç†
			prepareTableForEmail(clonedTable);
			styleTableForEmail(clonedTable);

			// ğŸ” æŠŠä½¿ç”¨è€…å¡«å…¥çš„è³‡æ–™è½‰ç‚ºéœæ…‹æ–‡å­—
			//prepareTableForEmail(".table2");
			//styleTableForEmail(".table2");     // æŠŠè¡¨æ ¼åŠ ä¸Šæ ¼ç·š & æ¨£å¼

			// å–å¾—éœæ…‹è¡¨æ ¼ HTML
			document.getElementById("table_content").value = clonedTable.outerHTML;

			// å–å¾—ä½¿ç”¨è€…è¼¸å…¥çš„è³‡æ–™
			const company = document.getElementById("input_company").value;
			const name = document.getElementById("input_name").value;
			const phone = document.getElementById("input_phone").value;
			const email = document.getElementById("input_email").value;
			const ordernumber = document.getElementById("input_ordernumber").value;

			// è¨­å®šåˆ°å°æ‡‰çš„ hidden æ¬„ä½
			document.getElementById("user_company").value = company;
			document.getElementById("user_name").value = name;
			document.getElementById("user_phone").value = phone;
			document.getElementById("user_email").value = email;
			document.getElementById("user_ordernumber").value = ordernumber;
			document.getElementById("user_memory").value = total_price;

			const serialNumber = generateSerialNumber();
			document.getElementById("user_serialnumber").value = serialNumber;

            const constform = document.getElementById("orderForm");
			// ç¢ºèªé€å‡º
			emailjs.sendForm('service_cou7ucc', 'template_ac4gzdw', constform)
			  .then(function (response) {

				document.getElementById("display_serialnumber").textContent = "æ‚¨çš„é›»ç¹¡å–®å–®è™Ÿæ˜¯: " + serialNumber;
				
				// é¡¯ç¤º copy æŒ‰éˆ•
				const copyBtn = document.getElementById("copyButton");
				copyBtn.style.display = "inline-block";

				// å„²å­˜é›»ç¹¡å–®å–®è™Ÿåˆ°æŒ‰éˆ•å±¬æ€§ï¼ˆä¾›è¤‡è£½ç”¨ï¼‰
				copyBtn.setAttribute("data-serial", serialNumber);
				
				alert('âœ… å·²æˆåŠŸé€å‡ºä¿¡ä»¶ï¼');
				console.log('æˆåŠŸ', response);
			  }, function (error) {
				alert('âŒ ç™¼é€å¤±æ•—ï¼š' + JSON.stringify(error));
				console.error('éŒ¯èª¤', error);
			  });
		}
    });
});

// ç¶å®šè¤‡è£½æŒ‰éˆ•çš„è¡Œç‚º
document.getElementById("copyButton").addEventListener("click", function () {
    const serial = this.getAttribute("data-serial");

    // è¤‡è£½åˆ°å‰ªè²¼ç°¿
    navigator.clipboard.writeText(serial).then(function () {
        alert("âœ… å·²è¤‡è£½å–®è™Ÿï¼š" + serial);
    }, function (err) {
        alert("âŒ è¤‡è£½å¤±æ•—ï¼š" + err);
    });
});

</script>

</html>



